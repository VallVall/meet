(this["webpackJsonpwebrtc-meet"]=this["webpackJsonpwebrtc-meet"]||[]).push([[0],{33:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),i=n(17),o=n.n(i),r=(n(33),n(16)),s=n(25),d=(n(44),n(35),n(43),n(66)),f=n(63),u=n(65),l=n(64),j=n(22),b=n(7);s.a.initializeApp({apiKey:"AIzaSyBnx4aisChaY4rOJp4EBkJLL0Y-3pdSACc",authDomain:"webrtc-meet-5675f.firebaseapp.com",projectId:"webrtc-meet-5675f",storageBucket:"webrtc-meet-5675f.appspot.com",messagingSenderId:"830666454636",appId:"1:830666454636:web:6430c0c3d1184037158a49"});var h,O=s.a.firestore(),m=300,p=function(){var e=a.a.useState(Object(d.a)()),t=Object(r.a)(e,1)[0],n=a.a.useRef(null),c=a.a.useRef(null),i=a.a.useState(!1),o=Object(r.a)(i,2),s=o[0],p=o[1],v=a.a.useState(!1),g=Object(r.a)(v,2),x=g[0],y=g[1],S=O.collection("iceCandidates"),w=Object(j.a)(S),C=Object(r.a)(w,1)[0],k=O.collection("offers"),E=Object(j.a)(k),J=Object(r.a)(E,1)[0],L=O.collection("answers"),D=Object(j.a)(L),I=Object(r.a)(D,1)[0],R=a.a.useState([]),T=Object(r.a)(R,2),N=T[0];T[1];return a.a.useEffect((function(){(h=new RTCPeerConnection({iceServers:[{urls:["stun:stun.l.google.com:19302"]}]})).addEventListener("icecandidate",(function(e){var n=e.candidate;n&&S.add({name:t,candidate:JSON.stringify(n)})})),h.addEventListener("track",(function(e){var t=e.streams,n=Object(r.a)(t,1)[0];c.current&&(c.current.srcObject=n)}))}),[]),a.a.useEffect((function(){J&&J.forEach((function(e){var n=e.name,c=e.offer;n!==t&&(h.setRemoteDescription(JSON.parse(c)),h.createAnswer().then((function(e){h.setLocalDescription(e),L.add({name:t,offer:JSON.stringify(e)})})))}))}),[null===J||void 0===J?void 0:J.length]),a.a.useEffect((function(){I&&I.forEach((function(e){var n=e.name,c=e.offer;n!==t&&(N.includes(n)||h.setRemoteDescription(JSON.parse(c)))}))}),[null===I||void 0===I?void 0:I.length]),a.a.useEffect((function(){C&&C.filter((function(e){return e.name!==t})).forEach((function(e){console.log("item.name: ".concat(e.name,", my.name").concat(t)),h.addIceCandidate(JSON.parse(e.candidate))}))}),[null===C||void 0===C?void 0:C.length]),Object(b.jsxs)("div",{children:[Object(b.jsx)(f.a,{}),Object(b.jsxs)(l.a,{container:!0,justify:"center",spacing:2,children:[Object(b.jsx)(l.a,{item:!0,xs:12,container:!0,justify:"center",children:Object(b.jsxs)("div",{style:{background:"black",position:"relative",width:"fit-content"},children:[Object(b.jsx)("div",{style:{background:"gray",position:"absolute",top:0,right:0},children:Object(b.jsx)("video",{autoPlay:!0,ref:c,style:{width:100,height:100}})}),Object(b.jsx)("video",{autoPlay:!0,ref:n,style:{width:m,height:m}})]})}),Object(b.jsx)(l.a,{item:!0,xs:"auto",children:Object(b.jsx)(u.a,{variant:"contained",color:"primary",onClick:function(){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){n.current&&(n.current.srcObject=e,e.getTracks().forEach((function(t){h.addTrack(t,e)})),p(!0))}))},disabled:s,children:"Connect camera"})}),Object(b.jsx)(l.a,{item:!0,xs:"auto",children:Object(b.jsx)(u.a,{variant:"contained",color:"primary",onClick:function(){return h.createOffer({offerToReceiveVideo:!0,offerToReceiveAudio:!0}).then((function(e){h.setLocalDescription(e).then((function(){y(!0),k.add({name:t,offer:JSON.stringify(e)})}))}))},disabled:!s||x,children:"Call"})})]})]})},v=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,67)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),i(e),o(e)}))};o.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(p,{})}),document.getElementById("root")),v()}},[[42,1,2]]]);
//# sourceMappingURL=main.8f4bc36a.chunk.js.map